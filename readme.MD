# Mondo-HPO-Learner

## Goal
Our goal is to learn classifications in [MonDO disease ontology](https://github.com/monarch-initiative/monarch-disease-ontology), i.e. given existing MonDO classifications, learn fuzzy equivalence axioms. For example, we would like to know what would be a good class expression to define 'late onset Parkinson disease' using terms defined in [HPO ontology](http://human-phenotype-ontology.github.io), e.g., MONDO:0018466 (late onset Parkinson disease) can be defined as a an expression that consists of HP:0002322 (Resting tremor) and HP:0001300 (Parkinsonism) and ..., etc.

## Approach
We leveraged [DL-Learner](http://dl-learner.org) for inductive learning. DL-Learner is an OWL-based inductive learning framework. It allows the learning of class expressions to be used in an equivalent class expression, e.g., given data about people and their relationships, it can learn “Uncle = brother-of o has-child some Male”. Using the DL-Learner, our goal is to ‘learn’ all non-root classes in MonDO. Interested readers can also check [these slides](https://docs.google.com/presentation/d/1Huhj_PeasO9Gb9_8ebaQ4OFh4GadKGRFN-ZAJwRjyfI/edit?usp=sharing).

## Getting Started
### Prerequisites
Please download the following files in the root of the cloned directory. 

- [MonDO disease ontology](http://purl.obolibrary.org/obo/mondo/pre/mondo.owl)
- [HPO annotations](http://compbio.charite.de/jenkins/job/hpo.annotations/lastStableBuild/artifact/misc/phenotype_annotation.tab)
- [Human phenotype ontology](http://purl.obolibrary.org/obo/hp.obo)
- [MonDO disease to GO term list](https://github.com/realmarcin/MAK_results/blob/master/Inputs/MONDO_to_GO/mondo-leaves-to-go.tsv)
- [Human disease ontology](http://purl.obolibrary.org/obo/doid.owl)
- [Orphanet rare disease ontology](http://data.bioontology.org/ontologies/ORDO/submissions/11/download?apikey=8b5b7825-538d-40e0-9e9e-5ab9274a9aeb)
- [Neoplasm core from the NCI thesaurus OBO edition](http://purl.obolibrary.org/obo/ncit/neoplasm-core.owl)

Note that running Mondo-HPO-learner requires hp.owl but please do not use the one available on its official webpage because it contains too many complex expressions which cannot be processed by DL-learner's reasoners. We instead used a simplified version of hp.owl which can be generated by using [owltools](https://github.com/owlcollab/owltools) as follows.

~~~~
    target/owltools hp.obo --no-reasoner --merge-support-ontologies -o hp.owl
~~~~

### Installation and Usage
Once all files are ready, run the following commands for building and running the executable jar file.

~~~~
    mvn clean compile assembly:single

    java -jar target/mondohpolearner-0.0.1-SNAPSHOT-jar-with-dependencies.jar -m (learn class expressions over mondo.owl and HPO annotations)
    java -jar target/mondohpolearner-0.0.1-SNAPSHOT-jar-with-dependencies.jar -g (learn class expressions over mondo.owl and GO ontology)

    java -jar target/mondohpolearner-0.0.1-SNAPSHOT-jar-with-dependencies.jar -d (learn class expressions over doid.owl and HPO annotations)
    java -jar target/mondohpolearner-0.0.1-SNAPSHOT-jar-with-dependencies.jar -o (learn class expressions over ordo-orphanet.owl and HPO annotations)
    java -jar target/mondohpolearner-0.0.1-SNAPSHOT-jar-with-dependencies.jar -n (learn class expressions over neoplasm-core.owl (a part of NCI thesaurus))

    java -jar target/mondohpolearner-0.0.1-SNAPSHOT-jar-with-dependencies.jar -c (generate charts from the result of learnings)
~~~~

The execution of this program will generate the HTML files that show mappings between (i) MonDO classes and (ii) HPO classes with accuracy/precision in the 'report' directory. It is possible that processing some ontologies may require additional memories using jvm flags such as `-Xms1g -Xmx12g`.

### Results
We upload the report directory in this repository as well.
 - [The list of MONDO classes expressed with HPO terms](https://github.com/yy20716/mondo-hpo-learner/tree/master/mondohpo_report).
 - [The list of MONDO classes expressed with GO terms](https://github.com/yy20716/mondo-hpo-learner/tree/master/mondogo_report).
 - [The list of DO classes expressed with HPO terms](https://github.com/yy20716/mondo-hpo-learner/tree/master/doid_report).
 - [The list of Orphanet classes expressed with HPO terms](https://github.com/yy20716/mondo-hpo-learner/tree/master/orpha_report).
 - [The list of NCIT classes expressed with NCIT terms](https://github.com/yy20716/mondo-hpo-learner/tree/master/ncit_report) (Note: it only contains classes under neoplasm branches of NCIT).
  
## Contributors
- [Chris Mungall](https://github.com/cmungall)
- [Jim Balhoff](https://github.com/balhoff)
- [HyeongSik Kim](https://github.com/yy20716)




















































































































